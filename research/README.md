# Исследование по выбору хранилища оценок и избранных фильмов

## Запуск
1. Сформировать виртуальное Python-окружение `python -m venv venv`
2. Установить зависимости `pip install -r requirements.txt`
3. Создать файл `.env` с переменными окружения по аналогии с файлом `.env.example`
4. Запустить докер `docker compose up -d`
5. Запустить замер хранилищ `python src/main.py`

## Результаты исследования

- Единица измерения - секунда
- Операции чтения проводились по 20 раз. В качестве результата взято среднее значение
- В качестве данных использовалось: 200 000 избранных фильмов, 200 000 оценок фильмов

|Операция / Хранилище|MongoDB|Clickhouse|
|-|---------|------------|
|Наполнение данными|8.98910209996393|4.285825599974487|
|Чтение избранных фильмов пользователя|0.12804147000715602|0.04531229500134941|
|Чтение оценки фильма|0.09629540000169072|0.03071900499635376|
|Чтение оценки фильма во время записи|0.11618971000134479|0.12327861999801826|

## Итог

Было принято решение доработать действующий сервис, чтобы использовать единую шину доставки сообщений для всех событий - `Kafka`. Такой подход позволит подключать новых слушателей извне, не меняя код API сервиса.

При этом, в качестве хранилища для оценок, рецензий и избранных фильмов принято решение использовать `MongoDB`, т.к. `Clickhouse` предназначен для аналитической работы с большими объемами данных: хуже скорость чтения по конкретным `id`.